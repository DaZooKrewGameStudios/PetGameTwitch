name: UE5 Windows Build

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: self-hosted
    steps:
    - name: Set execution policy
      shell: powershell
      run: Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
    
    - name: Checkout code
      uses: actions/checkout@v3
      with:
        lfs: true
    - run: git config --global --add safe.directory .
    - run: git status
    - run: git lfs pull
      
    - name: Build UE5 Project
      uses: OrchidIsle/UE5-Build-Project@latest
      with:
        RUNUAT_PATH: '${{secrets.UE_PATH}}/Engine/Build/BatchFiles/RunUAT.bat'
        UPROJECT_PATH: '${{github.workspace}}/${{github.event.repository.name}}.uproject'
        BUILD_CONFIG: 'Development'
        PLATFORM: 'Win64'
        # Add other optional parameters as needed
